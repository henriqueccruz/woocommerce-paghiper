(function(){var D=Object.defineProperty;var N=(e,r,u)=>r in e?D(e,r,{enumerable:!0,configurable:!0,writable:!0,value:u}):e[r]=u;var C=(e,r,u)=>N(e,typeof r!="symbol"?r+"":r,u);jQuery(function(e){function r(n){const{message:i,type:t="info",duration:s=3e3}=n;e("#ph-reusable-notifications").length||e("body").append('<div id="ph-reusable-notifications"></div>');const c=e("<div></div>").addClass(`ph-notification ${t}`).html(i);return e("#ph-reusable-notifications").append(c),s>0&&setTimeout(()=>{c.addClass("fade-out"),c.on("animationend",()=>{c.remove()})},s),c}if(typeof paghiper_settings>"u"||!e("#paghiper-due-date-container").length)return;const y=e("#woocommerce_paghiper_pix_due_date_mode, #woocommerce_paghiper_billet_due_date_mode"),w=e("#woocommerce_paghiper_pix_due_date_value, #woocommerce_paghiper_billet_due_date_value"),b=e("#woocommerce_paghiper_pix_api_key, #woocommerce_paghiper_billet_api_key"),S=e("#copy-credentials, #test-credentials");b.length&&S.length&&S.insertAfter(b);const x=e("#due-date-mode-toggle"),f=e("#days-mode-section"),k=e("#minutes-mode-section");e(".mode-switcher.disabled").on("click",function(n){n.preventDefault(),r({message:"Essa opção está disponível apenas para o PIX PagHiper.",type:"info"})}),paghiper_settings.is_pix?x.on("change",function(){const n=e(this).is(":checked");f.toggleClass("active",!n),k.toggleClass("active",n),y.val(n?"minutes":"days").trigger("change"),g()}):(f.addClass("active"),k.removeClass("active"),y.val("days")),e("#mainform").on("submit",function(n){if(paghiper_settings.is_pix&&y.val()==="minutes"){const i=w.val();i<5&&(confirm(`A(s) transação(ões) gerada(s) vai(vão) expirar em apenas ${i} minutos. Continuar?`)||n.preventDefault())}});let p={},v;function g(){if(paghiper_settings.is_pix&&x.is(":checked")){const n=p.days.value,i=p.hours.value,t=p.minutes.value,s=n*24*60+i*60+t;w.val(s).trigger("change")}else w.val(v.value).trigger("change")}class I{constructor(i){this.element=e('<div class="odometer-digit"></div>'),this.currentValue=parseInt(i,10),this.rotor=e('<div class="odometer-rotor"></div>');for(let t=0;t<10;t++)this.rotor.append(e('<div class="odometer-digit-value"></div>').text(t));this.rotor.append(e('<div class="odometer-digit-value"></div>').text(0)),this.element.append(this.rotor)}initializePosition(){const i=this.element.height();i!==0&&this.rotor.css({transition:"none",transform:`translateY(-${this.currentValue*i}px)`})}setValue(i,t){if(i===this.currentValue)return;const s=this.element.height();if(s===0)return;const a=this.rotor,c=this.currentValue===9&&i===0&&t>0,o=this.currentValue===0&&i===9&&t<0;c?(a.css({transition:"transform 0.4s ease-in-out",transform:`translateY(-${10*s}px)`}),setTimeout(()=>{a.css({transition:"none",transform:"translateY(0px)"})},400)):o?(a.css({transition:"none",transform:`translateY(-${10*s}px)`}),setTimeout(()=>{a.css({transition:"transform 0.4s ease-in-out",transform:`translateY(-${9*s}px)`})},20)):a.css({transition:"transform 0.4s ease-in-out",transform:`translateY(-${i*s}px)`}),this.currentValue=i}}const _=class _{constructor(i,t,s){this.container=e(i),this.config=_.LIMITS[s],this.value=Math.max(this.config.min,Math.min(t,this.config.max)),this.digits=[],this.isEditing=!1,this.wrapper=e('<div class="odometer-display"></div>'),this.container.html(this.wrapper);const a=this.value>=100?3:2,c=this.value.toString().padStart(a,"0");for(let o=0;o<c.length;o++){const d=new I(c[o]);this.digits.push(d),this.wrapper.append(d.element),d.initializePosition()}this.digits.length===3?this.wrapper.addClass("has-three-digits"):this.wrapper.removeClass("has-three-digits"),this.wrapper.on("click",()=>{this.isEditing||this.showInput()})}showInput(){let i=this.wrapper.outerWidth(),t=this.wrapper.outerHeight();console.log(i,t),this.isEditing=!0,this.wrapper.hide();const s=e('<input type="number" class="odometer-input" />');s.css({"min-width":i+"px",width:i+"px",height:t+"px","font-size":"1.8em","text-align":"center",border:"1px solid #999","background-color":"#fff","box-sizing":"border-box",margin:0,padding:0}),s.val(this.value),this.container.append(s),s.focus().select();const a=e('<span style="display:none"></span>');a.css({"font-size":s.css("font-size"),"font-family":s.css("font-family")}),e("body").append(a),s.on("input",function(){a.text(e(this).val()),e(this).css("width",a.width()+10+"px")}).trigger("input");const c=()=>{let o=parseInt(s.val(),10);if(isNaN(o)?o=this.value:o=Math.max(this.config.min,Math.min(o,this.config.max)),s.remove(),this.wrapper.show(),this.isEditing=!1,o!==this.value){const d=o>this.value?1:-1;this.setValue(o,d),g()}};s.on("blur",c),s.on("keydown",o=>{o.key==="Enter"?c():o.key==="Escape"&&(s.remove(),this.wrapper.show(),this.isEditing=!1)})}setValue(i,t){if(i===this.value)return;const s=i>=100?3:2,a=this.value.toString(),c=i.toString(),o=this.digits.length,d=Math.max(s,c.length);if(d>o)for(let l=o;l<d;l++){const m=new I("0");this.digits.unshift(m),this.wrapper.prepend(m.element),m.initializePosition()}else if(d<o)for(let l=d;l<o;l++)this.digits[0].element.remove(),this.digits.shift();d===3?this.wrapper.addClass("has-three-digits"):this.wrapper.removeClass("has-three-digits");const V=a.padStart(this.digits.length,"0"),z=c.padStart(this.digits.length,"0");for(let l=0;l<this.digits.length;l++){const m=parseInt(V[l],10),M=parseInt(z[l],10);m!==M&&this.digits[l].setValue(M,t)}this.value=i}increment(){let i=!1,t=this.value+1;return t>this.config.max&&(t=this.config.wrap?this.config.min:this.config.max,i=!0),this.setValue(t,1),i}decrement(){let i=!1,t=this.value-1;return t<this.config.min&&(t=this.config.max,i=!0),this.setValue(t,-1),i}};C(_,"LIMITS",{"boleto-days":{min:1,max:400,wrap:!0},"pix-days":{min:0,max:400,wrap:!0},hours:{min:0,max:23,wrap:!0},minutes:{min:0,max:59,wrap:!0}});let h=_;const E=paghiper_settings.due_date_mode==="days"?parseInt(paghiper_settings.due_date_value,10):1,T=paghiper_settings.is_pix?"pix-days":"boleto-days";if(v=new h(f.find(".days-display"),E,T),f.find(".chevron-control").on("click",function(){if(e(".odometer-input").length){e(".odometer-input").trigger("blur");return}e(this).data("action")==="increment"?v.increment():v.decrement(),g()}),paghiper_settings.is_pix){let n=function(){let i={days:0,hours:0,minutes:30};if(paghiper_settings.due_date_mode==="minutes"){const t=parseInt(paghiper_settings.due_date_value,10);!isNaN(t)&&t>0&&(i={days:Math.floor(t/(24*60)),hours:Math.floor(t%(24*60)/60),minutes:t%60})}p.days=new h(e("#cron-days-pix"),i.days,"pix-days"),p.hours=new h(e("#cron-hours-pix"),i.hours,"hours"),p.minutes=new h(e("#cron-minutes-pix"),i.minutes,"minutes"),g()};var P=n;n(),e("#minutes-mode-section .chevron-control").on("click",function(){if(e(".odometer-input").length){e(".odometer-input").trigger("blur");return}const i=e(this),t=i.data("unit");i.data("action")==="increment"?p[t].increment()&&(t==="minutes"?p.hours.increment()&&p.days.increment():t==="hours"&&p.days.increment()):p[t].decrement()&&(t==="minutes"?p.hours.decrement()&&p.days.decrement():t==="hours"&&p.days.decrement()),g()}),x.trigger("change")}e("#copy-credentials").on("click",function(){let n=null;n=r({message:'<span class="ph-notification-spinner"></span> Copiando credenciais...',type:"info",duration:0}),e.post(ajaxurl,{action:"paghiper_copy_credentials",nonce:paghiper_settings.nonce,to:paghiper_settings.gateway_id},function(t){t.success?(r({message:"Credenciais configuradas com sucesso!",type:"success",duration:5e3}),setTimeout(()=>{location.reload()},1e3)):r({message:t.data.message,type:"error"}),n&&n.remove()})}),e("#test-credentials").on("click",function(){const n=e("#woocommerce_paghiper_pix_api_key, #woocommerce_paghiper_billet_api_key").val(),i=e("#woocommerce_paghiper_pix_token, #woocommerce_paghiper_billet_token").val();let t=null;t=r({message:'<span class="ph-notification-spinner"></span> Testando credenciais...',type:"info",duration:0}),e.post(ajaxurl,{action:"paghiper_test_credentials",nonce:paghiper_settings.nonce,apiKey:n,token:i},function(a){a.success?r({message:a.data.message,type:"success"}):r({message:a.data.message,type:"error"}),t&&t.remove()}).fail(function(a,c,o){a.status===500?r({message:"Servidor indisponível (erro 500)",type:"error"}):r({message:"Não foi possível checar suas credenciais agora.",type:"error"}),t&&t.remove()})})});
//# sourceMappingURL=admin.min.js.map
})();