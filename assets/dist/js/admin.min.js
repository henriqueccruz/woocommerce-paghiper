(function(){jQuery(function(e){if(!e("#paghiper-due-date-container").length)return;const f=e("#due-date-mode-toggle"),h=e("#days-mode-section"),v=e("#minutes-mode-section");class y{constructor(t,n=!1){this.element=e('<div class="odometer-digit">'),this.innerElement=e('<div class="odometer-digit-inner">'),this.currentValue=parseInt(t,10),this.isLast=n,this.element.append(this.innerElement),this.updateDisplay()}updateDisplay(){this.innerElement.html(`
                <span class="odometer-digit-value">${this.currentValue}</span>
                <span class="odometer-digit-value">${this.getNextValue(1)}</span>
                <span class="odometer-digit-value">${this.getNextValue(-1)}</span>
            `)}getNextValue(t){if(this.isLast){let n=this.currentValue+t;return n>9&&(n=0),n<0&&(n=9),n}return this.currentValue}setValue(t,n){if(t===this.currentValue)return!1;const i=n>0?"rolling-up":"rolling-down";return this.element.addClass(i),setTimeout(()=>{this.currentValue=t,this.updateDisplay(),this.element.removeClass(i)},200),!0}}class c{constructor(t,n,i=99){this.container=e(t),this.maxValue=i,this.value=n,this.digits=[],this.wrapper=e('<div class="odometer-display">'),this.container.html(this.wrapper);const o=this.value.toString().padStart(2,"0");for(let a=0;a<o.length;a++){const d=new y(o[a],a===o.length-1);this.digits.push(d),this.wrapper.append(d.element)}}setValue(t,n=!0){if(t===this.value)return;t=Math.max(0,Math.min(t,this.maxValue));const i=this.value.toString().padStart(2,"0"),o=t.toString().padStart(2,"0");for(let a=0;a<this.digits.length;a++){const d=parseInt(i[a],10),g=parseInt(o[a],10);if(d!==g){const M=t>this.value?1:-1;this.digits[a].setValue(g,M)}}this.value=t}}const m=e("#woocommerce_paghiper_pix_due_date_mode"),l=e("#woocommerce_paghiper_pix_due_date_value");f.on("change",function(){const s=e(this).is(":checked");h.toggleClass("active",!s),v.toggleClass("active",s),m.val(s?"minutes":"days").trigger("change")}).trigger("change");const _=paghiper_settings.due_date_mode==="days"?parseInt(paghiper_settings.due_date_value,10):3,p=new c(h.find(".days-display"),_,3);h.find(".chevron-control").on("click",function(){const s=e(this).data("action")==="increment"?1:-1,t=Math.max(1,Math.min(3,p.value+s));t!==p.value&&(p.setValue(t),l.val(t).trigger("change"))});function D(){const s=parseInt(e("#cron-days").text()),t=parseInt(e("#cron-hours").text()),n=parseInt(e("#cron-minutes").text()),i=s*24*60+t*60+n;l.val(i).trigger("change")}let r={days:null,hours:null,minutes:null};const u={days:3,hours:23,minutes:59};function I(){let s={days:0,hours:0,minutes:0};if(paghiper_settings.due_date_mode==="minutes"){const t=parseInt(paghiper_settings.due_date_value,10);s={days:Math.floor(t/(24*60)),hours:Math.floor(t%(24*60)/60),minutes:t%60}}r.days=new c(e("#cron-days"),s.days,u.days),r.hours=new c(e("#cron-hours"),s.hours,u.hours),r.minutes=new c(e("#cron-minutes"),s.minutes,u.minutes)}I(),e(".chrono-control").on("click",function(){const s=e(this).data("unit"),n=e(this).data("action")==="increment"?1:-1;let i=r[s].value+n;i<0?i=u[s]:i>u[s]&&(i=0),r[s].setValue(i),D()}),e("form#mainform").on("submit",function(s){if(m.val()==="minutes"){const t=parseInt(l.val(),10),n=3*24*60;if(t>n&&confirm('Configurações de vencimento superiores a 3 dias no modo cronômetro podem usar mais recursos. Deseja converter para o modo "Dias" para melhor performance?')){s.preventDefault();const o=Math.ceil(t/(24*60));m.val("days"),l.val(o),setTimeout(()=>e(this).submit(),100)}}})});
})();