(function(){var E=Object.defineProperty;var D=(t,s,r)=>s in t?E(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r;var S=(t,s,r)=>D(t,typeof s!="symbol"?s+"":s,r);jQuery(document).ready(function(t){if(t(".paghiper-dismiss-notice").on("click",".notice-dismiss",function(){var h={action:"paghiper_dismiss_notice",notice:t(this).parent().data("notice-id")};t.post(notice_params.ajaxurl,h,function(){})}),t(".paghiper-notice").on("click",".ajax-action",function(){let o=t(this).data("notice-key"),h=t(this).data("action");var g={action:"paghiper_answer_notice",noticeId:o,userAction:h};t.post(notice_params.ajaxurl,g,function(){}),t(".paghiper-review-nag").hide()}),typeof t.fn.mask=="function"&&t(".date").mask("00/00/0000",{placeholder:"__/__/____",clearIfNotMatch:!0}),t(".paghiper-copy-transaction-id").on("click",function(){const o=t(this).data("transaction-id");o&&(C(o),I({message:"ID da transação copiado!",type:"success"}))}),t("#paghiper-due-date-container").length){let _=function(){const d=a.days.value,e=a.hours.value,i=a.minutes.value,n=d*24*60+e*60+i;o.val(n).trigger("change")},x=function(){const d=a.days;d.value===d.config.max&&(a.hours.value!==0&&a.hours.setValue(0,-1),a.minutes.value!==0&&a.minutes.setValue(0,-1))},w=function(){let d={days:0,hours:0,minutes:0};const e=paghiper_backend_settings.initial_datetime_value;if(e){const i=e.match(/(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})/);if(i){const n=parseInt(i[1],10),c=parseInt(i[2],10)-1,v=parseInt(i[3],10),u=parseInt(i[4],10),p=parseInt(i[5],10),k=new Date(n,c,v,u,p,0),T=new Date,l=k.getTime()-T.getTime(),f=Math.round(l/(1e3*60));f>0&&(d={days:Math.floor(f/(24*60)),hours:Math.floor(f%(24*60)/60),minutes:f%60})}}a.days=new g(t("#cron-days-backend"),d.days,"pix-days"),a.hours=new g(t("#cron-hours-backend"),d.hours,"hours"),a.minutes=new g(t("#cron-minutes-backend"),d.minutes,"minutes"),x(),_()};var r=_,m=x,y=w;const o=t("#woo_paghiper_expiration_date");class h{constructor(e){this.element=t('<div class="odometer-digit"></div>'),this.currentValue=parseInt(e,10),this.rotor=t('<div class="odometer-rotor"></div>');for(let i=0;i<10;i++)this.rotor.append(t('<div class="odometer-digit-value"></div>').text(i));this.rotor.append(t('<div class="odometer-digit-value"></div>').text(0)),this.element.append(this.rotor)}initializePosition(){const e=this.element.height();e!==0&&this.rotor.css({transition:"none",transform:`translateY(-${this.currentValue*e}px)`})}setValue(e,i){if(e===this.currentValue)return;const n=this.element.height();if(n===0)return;const c=this.rotor,v=this.currentValue===9&&e===0&&i>0,u=this.currentValue===0&&e===9&&i<0;v?(c.css({transition:"transform 0.4s ease-in-out"}),c.css({transform:`translateY(-${10*n}px)`}),setTimeout(()=>{c.css({transition:"none",transform:"translateY(0px)"})},400)):u?(c.css({transition:"none",transform:`translateY(-${10*n}px)`}),setTimeout(()=>{c.css({transition:"transform 0.4s ease-in-out"}),c.css({transform:`translateY(-${9*n}px)`})},20)):(c.css({transition:"transform 0.4s ease-in-out"}),c.css({transform:`translateY(-${e*n}px)`})),this.currentValue=e}}const b=class b{constructor(e,i,n){this.container=t(e),this.config=b.LIMITS[n],this.value=Math.max(this.config.min,Math.min(i,this.config.max)),this.digits=[],this.isEditing=!1,this.wrapper=t('<div class="odometer-display"></div>'),this.container.html(this.wrapper);const v=this.value.toString().padStart(2,"0");for(let u=0;u<v.length;u++){const p=new h(v[u]);this.digits.push(p),this.wrapper.append(p.element),p.initializePosition()}this.digits.length===3?this.wrapper.addClass("has-three-digits"):this.wrapper.removeClass("has-three-digits"),this.wrapper.on("click",()=>{this.isEditing||this.showInput()})}showInput(){this.isEditing=!0,this.wrapper.hide();const e=t('<input type="number" class="odometer-input" />');e.css({width:this.wrapper.outerWidth()+"px",height:this.wrapper.outerHeight()+"px","font-size":"1.8em","text-align":"center",border:"1px solid #999","background-color":"#fff","box-sizing":"border-box",margin:0,padding:0}),e.val(this.value),this.container.append(e),e.focus().select();const i=()=>{let n=parseInt(e.val(),10);if(isNaN(n)?n=this.value:n=Math.max(this.config.min,Math.min(n,this.config.max)),e.remove(),this.wrapper.show(),this.isEditing=!1,n!==this.value){const c=n>this.value?1:-1;this.setValue(n,c),x(),_()}};e.on("blur",i),e.on("keydown",n=>{n.key==="Enter"?i():n.key==="Escape"&&(e.remove(),this.wrapper.show(),this.isEditing=!1)})}setValue(e,i){if(e===this.value)return;const n=2,c=this.value.toString(),v=e.toString(),u=this.digits.length,p=Math.max(n,v.length);if(p>u)for(let l=u;l<p;l++){const f=new h("0");this.digits.unshift(f),this.wrapper.prepend(f.element),f.initializePosition()}else if(p<u)for(let l=p;l<u;l++)this.digits[0].element.remove(),this.digits.shift();p===3?this.wrapper.addClass("has-three-digits"):this.wrapper.removeClass("has-three-digits");const k=c.padStart(this.digits.length,"0"),T=v.padStart(this.digits.length,"0");for(let l=0;l<this.digits.length;l++){const f=parseInt(k[l],10),M=parseInt(T[l],10);f!==M&&this.digits[l].setValue(M,i)}this.value=e}increment(){let e=!1,i=this.value+1;return i>this.config.max&&(this.config.wrap?(i=this.config.min,e=!0):i=this.config.max),this.setValue(i,1),e}decrement(){let e=!1,i=this.value-1;return i<this.config.min&&this.config.wrap&&(i=this.config.max,e=!0),this.setValue(i,-1),e}};S(b,"LIMITS",{"pix-days":{min:0,max:400,wrap:!0},hours:{min:0,max:23,wrap:!0},minutes:{min:0,max:59,wrap:!0}});let g=b,a={};paghiper_backend_settings.is_pix&&paghiper_backend_settings.due_date_mode==="minutes"&&(w(),t("#paghiper-due-date-container .chevron-control").on("click",function(){const d=t(this),e=d.data("unit");d.data("action")==="increment"?a[e].increment()&&(e==="minutes"?a.hours.increment()&&a.days.increment():e==="hours"&&a.days.increment()):a[e].decrement()&&(e==="minutes"?a.hours.decrement()&&a.days.decrement():e==="hours"&&a.days.decrement()),x(),_()}))}t("body").on("click","#paghiper-resend-ajax-button",function(o){o.preventDefault();const h=t(this),g=h.data("order-id"),a=t("#woo_paghiper_expiration_date").val();if(a/60>24&&!confirm("A data de vencimento é maior que 24 horas a partir de agora. O cronômetro de contagem regressiva não será exibido no e-mail do cliente. Deseja continuar?"))return;h.prop("disabled",!0).text("Enviando...");const x={action:"paghiper_resend_payment",order_id:g,total_minutes:a,security:t("#paghiper_resend_nonce").val()};t.post(ajaxurl,x,function(w){w.success?(I({message:w.data.message,type:"success"}),setTimeout(()=>window.location.reload(),2e3)):I({message:w.data.message,type:"error"}),h.prop("disabled",!1).text("Definir e Reenviar")}).fail(function(){I({message:"Ocorreu um erro inesperado. Tente novamente.",type:"error"}),h.prop("disabled",!1).text("Definir e Reenviar")})})});async function C(t){if(navigator.clipboard&&window.isSecureContext)try{return await navigator.clipboard.writeText(t),!0}catch(m){console.error("Falha ao copiar com a API moderna: ",m)}const s=document.createElement("textarea");s.value=t,s.style.position="fixed",s.style.top="-9999px",s.style.left="-9999px",document.body.appendChild(s),s.focus(),s.select();let r=!1;try{r=document.execCommand("copy")}catch(m){console.error("Erro ao tentar copiar com o método de fallback: ",m)}return document.body.removeChild(s),r}function I(t){const{message:s,type:r="info",duration:m=3e3}=t,y=document.getElementById("ph-reusable-notifications");if(!y)return null;const o=document.createElement("div");return o.className=`ph-notification ${r}`,o.innerHTML=s,y.appendChild(o),m>0&&setTimeout(()=>{o.classList.add("fade-out"),o.addEventListener("animationend",()=>{o.remove()})},m),o}window.copyPaghiperEmv=function(){let t=document.querySelector(".paghiper-pix-code"),s=t.querySelector("textarea"),r=t.querySelector("button");s.select(),s.setSelectionRange(0,99999),navigator.clipboard.writeText(s.value),r.dataset.originalText=r.innerHTML,r.innerHTML="Copiado!",setTimeout(function(m){let y=m.dataset.originalText;m.innerHTML=y,document.getSelection().removeAllRanges()},2e3,r)};
//# sourceMappingURL=backend.min.js.map
})();