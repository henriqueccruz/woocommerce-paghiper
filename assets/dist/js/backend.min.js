(function(){var D=Object.defineProperty;var C=(t,s,d)=>s in t?D(t,s,{enumerable:!0,configurable:!0,writable:!0,value:d}):t[s]=d;var E=(t,s,d)=>C(t,typeof s!="symbol"?s+"":s,d);jQuery(document).ready(function(t){if(t(".paghiper-dismiss-notice").on("click",".notice-dismiss",function(){var m={action:"paghiper_dismiss_notice",notice:t(this).parent().data("notice-id")};t.post(notice_params.ajaxurl,m,function(){})}),t(".paghiper-notice").on("click",".ajax-action",function(){let r=t(this).data("notice-key"),m=t(this).data("action");var g={action:"paghiper_answer_notice",noticeId:r,userAction:m};t.post(notice_params.ajaxurl,g,function(){}),t(".paghiper-review-nag").hide()}),typeof t.fn.mask=="function"&&t(".date").mask("00/00/0000",{placeholder:"__/__/____",clearIfNotMatch:!0}),t(".paghiper-copy-transaction-id").on("click",function(){const r=t(this).data("transaction-id");r&&(V(r),I({message:"ID da transação copiado!",type:"success"}))}),t("#paghiper-due-date-container").length){let y=function(){if(paghiper_backend_settings.due_date_mode==="minutes"){const l=o.days.value,e=o.hours.value,i=o.minutes.value,n=l*24*60+e*60+i;r.val(n).trigger("change")}else r.val(_.value*24*60).trigger("change")},x=function(){if(paghiper_backend_settings.due_date_mode==="minutes"){const l=o.days;l.value===l.config.max&&(o.hours.value!==0&&o.hours.setValue(0,-1),o.minutes.value!==0&&o.minutes.setValue(0,-1))}},M=function(){let l={days:0,hours:0,minutes:0};const e=paghiper_backend_settings.initial_datetime_value;if(e){const i=e.match(/(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})/);if(i){const n=parseInt(i[1],10),c=parseInt(i[2],10)-1,p=parseInt(i[3],10),a=parseInt(i[4],10),u=parseInt(i[5],10),k=new Date(n,c,p,a,u,0),T=new Date,h=k.getTime()-T.getTime(),v=Math.round(h/(1e3*60));v>0&&(l={days:Math.floor(v/(24*60)),hours:Math.floor(v%(24*60)/60),minutes:v%60})}}paghiper_backend_settings.due_date_mode==="minutes"?(o.days=new g(t("#cron-days-backend-minutes"),l.days,"pix-days"),o.hours=new g(t("#cron-hours-backend"),l.hours,"hours"),o.minutes=new g(t("#cron-minutes-backend"),l.minutes,"minutes")):_=new g(t("#cron-days-backend"),l.days,"pix-days"),x(),y()};var d=y,f=x,w=M;const r=t("#woo_paghiper_expiration_date");class m{constructor(e){this.element=t('<div class="odometer-digit"></div>'),this.currentValue=parseInt(e,10),this.rotor=t('<div class="odometer-rotor"></div>');for(let i=0;i<10;i++)this.rotor.append(t('<div class="odometer-digit-value"></div>').text(i));this.rotor.append(t('<div class="odometer-digit-value"></div>').text(0)),this.element.append(this.rotor)}initializePosition(){const e=this.element.height();e!==0&&this.rotor.css({transition:"none",transform:`translateY(-${this.currentValue*e}px)`})}setValue(e,i){if(e===this.currentValue)return;const n=this.element.height();if(n===0)return;const c=this.rotor,p=this.currentValue===9&&e===0&&i>0,a=this.currentValue===0&&e===9&&i<0;p?(c.css({transition:"transform 0.4s ease-in-out"}),c.css({transform:`translateY(-${10*n}px)`}),setTimeout(()=>{c.css({transition:"none",transform:"translateY(0px)"})},400)):a?(c.css({transition:"none",transform:`translateY(-${10*n}px)`}),setTimeout(()=>{c.css({transition:"transform 0.4s ease-in-out"}),c.css({transform:`translateY(-${9*n}px)`})},20)):(c.css({transition:"transform 0.4s ease-in-out"}),c.css({transform:`translateY(-${e*n}px)`})),this.currentValue=e}}const b=class b{constructor(e,i,n){this.container=t(e),this.config=b.LIMITS[n],this.value=Math.max(this.config.min,Math.min(i,this.config.max)),this.digits=[],this.isEditing=!1,this.wrapper=t('<div class="odometer-display"></div>'),this.container.html(this.wrapper);const p=this.value.toString().padStart(2,"0");for(let a=0;a<p.length;a++){const u=new m(p[a]);this.digits.push(u),this.wrapper.append(u.element),u.initializePosition()}this.digits.length===3?this.wrapper.addClass("has-three-digits"):this.wrapper.removeClass("has-three-digits"),this.wrapper.on("click",()=>{this.isEditing||this.showInput()})}showInput(){let e=this.wrapper.outerWidth(),i=this.wrapper.outerHeight();this.isEditing=!0,this.wrapper.hide();const n=t('<input type="number" class="odometer-input" />');n.css({width:e+"px",height:i+"px","font-size":"1.8em","text-align":"center",border:"1px solid #999","background-color":"#fff","box-sizing":"border-box",margin:0,padding:0}),n.val(this.value),this.container.append(n),n.focus().select();const c=t('<span style="display:none"></span>');c.css({"font-size":n.css("font-size"),"font-family":n.css("font-family")}),t("body").append(c),n.on("input",function(){c.text(t(this).val()),t(this).css("width",c.width()+10+"px")}).trigger("input");const p=()=>{let a=parseInt(n.val(),10);if(isNaN(a)?a=this.value:a=Math.max(this.config.min,Math.min(a,this.config.max)),n.remove(),this.wrapper.show(),this.isEditing=!1,a!==this.value){const u=a>this.value?1:-1;this.setValue(a,u),x(),y()}};n.on("blur",p),n.on("keydown",a=>{a.key==="Enter"?p():a.key==="Escape"&&(n.remove(),this.wrapper.show(),this.isEditing=!1)})}setValue(e,i){if(e===this.value)return;const n=2,c=this.value.toString(),p=e.toString(),a=this.digits.length,u=Math.max(n,p.length);if(u>a)for(let h=a;h<u;h++){const v=new m("0");this.digits.unshift(v),this.wrapper.prepend(v.element),v.initializePosition()}else if(u<a)for(let h=u;h<a;h++)this.digits[0].element.remove(),this.digits.shift();u===3?this.wrapper.addClass("has-three-digits"):this.wrapper.removeClass("has-three-digits");const k=c.padStart(this.digits.length,"0"),T=p.padStart(this.digits.length,"0");for(let h=0;h<this.digits.length;h++){const v=parseInt(k[h],10),S=parseInt(T[h],10);v!==S&&this.digits[h].setValue(S,i)}this.value=e}increment(){let e=!1,i=this.value+1;return i>this.config.max&&(this.config.wrap?(i=this.config.min,e=!0):i=this.config.max),this.setValue(i,1),e}decrement(){let e=!1,i=this.value-1;return i<this.config.min&&this.config.wrap&&(i=this.config.max,e=!0),this.setValue(i,-1),e}};E(b,"LIMITS",{"pix-days":{min:0,max:400,wrap:!0},hours:{min:0,max:23,wrap:!0},minutes:{min:0,max:59,wrap:!0}});let g=b,o={},_;M(),t("#paghiper-due-date-container .chevron-control").on("click",function(){if(t(".odometer-input").length){t(".odometer-input").trigger("blur");return}const l=t(this),e=l.data("unit"),i=l.data("action");paghiper_backend_settings.due_date_mode==="minutes"?i==="increment"?o[e].increment()&&(e==="minutes"?o.hours.increment()&&o.days.increment():e==="hours"&&o.days.increment()):o[e].decrement()&&(e==="minutes"?o.hours.decrement()&&o.days.decrement():e==="hours"&&o.days.decrement()):i==="increment"?_.increment():_.decrement(),x(),y()})}t("body").on("click","#paghiper-resend-ajax-button",function(r){r.preventDefault();const m=t(this),g=m.data("order-id"),o=t("#woo_paghiper_expiration_date").val();if(o/60>24&&!confirm("A data de vencimento é maior que 24 horas a partir de agora. O cronômetro de contagem regressiva não será exibido no e-mail do cliente. Deseja continuar?"))return;m.prop("disabled",!0).text("Enviando...");const y={action:"paghiper_resend_payment",order_id:g,total_minutes:o,security:t("#paghiper_resend_nonce").val()};t.post(ajaxurl,y,function(x){x.success?(I({message:x.data.message,type:"success"}),setTimeout(()=>window.location.reload(),2e3)):I({message:x.data.message,type:"error"}),m.prop("disabled",!1).text("Definir e Reenviar")}).fail(function(){I({message:"Ocorreu um erro inesperado. Tente novamente.",type:"error"}),m.prop("disabled",!1).text("Definir e Reenviar")})})});async function V(t){if(navigator.clipboard&&window.isSecureContext)try{return await navigator.clipboard.writeText(t),!0}catch(f){console.error("Falha ao copiar com a API moderna: ",f)}const s=document.createElement("textarea");s.value=t,s.style.position="fixed",s.style.top="-9999px",s.style.left="-9999px",document.body.appendChild(s),s.focus(),s.select();let d=!1;try{d=document.execCommand("copy")}catch(f){console.error("Erro ao tentar copiar com o método de fallback: ",f)}return document.body.removeChild(s),d}function I(t){const{message:s,type:d="info",duration:f=3e3}=t,w=document.getElementById("ph-reusable-notifications");if(!w)return null;const r=document.createElement("div");return r.className=`ph-notification ${d}`,r.innerHTML=s,w.appendChild(r),f>0&&setTimeout(()=>{r.classList.add("fade-out"),r.addEventListener("animationend",()=>{r.remove()})},f),r}window.copyPaghiperEmv=function(){let t=document.querySelector(".paghiper-pix-code"),s=t.querySelector("textarea"),d=t.querySelector("button");s.select(),s.setSelectionRange(0,99999),navigator.clipboard.writeText(s.value),d.dataset.originalText=d.innerHTML,d.innerHTML="Copiado!",setTimeout(function(f){let w=f.dataset.originalText;f.innerHTML=w,document.getSelection().removeAllRanges()},2e3,d)};
//# sourceMappingURL=backend.min.js.map
})();