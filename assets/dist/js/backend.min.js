(function(){var E=Object.defineProperty;var D=(t,s,d)=>s in t?E(t,s,{enumerable:!0,configurable:!0,writable:!0,value:d}):t[s]=d;var S=(t,s,d)=>D(t,typeof s!="symbol"?s+"":s,d);jQuery(document).ready(function(t){if(t(".paghiper-dismiss-notice").on("click",".notice-dismiss",function(){var m={action:"paghiper_dismiss_notice",notice:t(this).parent().data("notice-id")};t.post(notice_params.ajaxurl,m,function(){})}),t(".paghiper-notice").on("click",".ajax-action",function(){let c=t(this).data("notice-key"),m=t(this).data("action");var v={action:"paghiper_answer_notice",noticeId:c,userAction:m};t.post(notice_params.ajaxurl,v,function(){}),t(".paghiper-review-nag").hide()}),typeof t.fn.mask=="function"&&t(".date").mask("00/00/0000",{placeholder:"__/__/____",clearIfNotMatch:!0}),t(".paghiper-copy-transaction-id").on("click",function(){const c=t(this).data("transaction-id");c&&(C(c),I({message:"ID da transação copiado!",type:"success"}))}),t("#paghiper-due-date-container").length){let _=function(){const l=o.days.value,e=o.hours.value,i=o.minutes.value,n=l*24*60+e*60+i;c.val(n).trigger("change")},x=function(){const l=o.days;l.value===l.config.max&&(o.hours.value!==0&&o.hours.setValue(0,-1),o.minutes.value!==0&&o.minutes.setValue(0,-1))},w=function(){let l={days:0,hours:0,minutes:0};const e=paghiper_backend_settings.initial_datetime_value;if(e){const i=e.match(/(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})/);if(i){const n=parseInt(i[1],10),r=parseInt(i[2],10)-1,p=parseInt(i[3],10),a=parseInt(i[4],10),u=parseInt(i[5],10),k=new Date(n,r,p,a,u,0),T=new Date,h=k.getTime()-T.getTime(),g=Math.round(h/(1e3*60));g>0&&(l={days:Math.floor(g/(24*60)),hours:Math.floor(g%(24*60)/60),minutes:g%60})}}o.days=new v(t("#cron-days-backend"),l.days,"pix-days"),o.hours=new v(t("#cron-hours-backend"),l.hours,"hours"),o.minutes=new v(t("#cron-minutes-backend"),l.minutes,"minutes"),x(),_()};var d=_,f=x,y=w;const c=t("#woo_paghiper_expiration_date");class m{constructor(e){this.element=t('<div class="odometer-digit"></div>'),this.currentValue=parseInt(e,10),this.rotor=t('<div class="odometer-rotor"></div>');for(let i=0;i<10;i++)this.rotor.append(t('<div class="odometer-digit-value"></div>').text(i));this.rotor.append(t('<div class="odometer-digit-value"></div>').text(0)),this.element.append(this.rotor)}initializePosition(){const e=this.element.height();e!==0&&this.rotor.css({transition:"none",transform:`translateY(-${this.currentValue*e}px)`})}setValue(e,i){if(e===this.currentValue)return;const n=this.element.height();if(n===0)return;const r=this.rotor,p=this.currentValue===9&&e===0&&i>0,a=this.currentValue===0&&e===9&&i<0;p?(r.css({transition:"transform 0.4s ease-in-out"}),r.css({transform:`translateY(-${10*n}px)`}),setTimeout(()=>{r.css({transition:"none",transform:"translateY(0px)"})},400)):a?(r.css({transition:"none",transform:`translateY(-${10*n}px)`}),setTimeout(()=>{r.css({transition:"transform 0.4s ease-in-out"}),r.css({transform:`translateY(-${9*n}px)`})},20)):(r.css({transition:"transform 0.4s ease-in-out"}),r.css({transform:`translateY(-${e*n}px)`})),this.currentValue=e}}const b=class b{constructor(e,i,n){this.container=t(e),this.config=b.LIMITS[n],this.value=Math.max(this.config.min,Math.min(i,this.config.max)),this.digits=[],this.isEditing=!1,this.wrapper=t('<div class="odometer-display"></div>'),this.container.html(this.wrapper);const p=this.value.toString().padStart(2,"0");for(let a=0;a<p.length;a++){const u=new m(p[a]);this.digits.push(u),this.wrapper.append(u.element),u.initializePosition()}this.digits.length===3?this.wrapper.addClass("has-three-digits"):this.wrapper.removeClass("has-three-digits"),this.wrapper.on("click",()=>{this.isEditing||this.showInput()})}showInput(){let e=this.wrapper.outerWidth(),i=this.wrapper.outerHeight();this.isEditing=!0,this.wrapper.hide();const n=t('<input type="number" class="odometer-input" />');n.css({width:e+"px",height:i+"px","font-size":"1.8em","text-align":"center",border:"1px solid #999","background-color":"#fff","box-sizing":"border-box",margin:0,padding:0}),n.val(this.value),this.container.append(n),n.focus().select();const r=t('<span style="display:none"></span>');r.css({"font-size":n.css("font-size"),"font-family":n.css("font-family")}),t("body").append(r),n.on("input",function(){r.text(t(this).val()),t(this).css("width",r.width()+10+"px")}).trigger("input");const p=()=>{let a=parseInt(n.val(),10);if(isNaN(a)?a=this.value:a=Math.max(this.config.min,Math.min(a,this.config.max)),n.remove(),this.wrapper.show(),this.isEditing=!1,a!==this.value){const u=a>this.value?1:-1;this.setValue(a,u),x(),_()}};n.on("blur",p),n.on("keydown",a=>{a.key==="Enter"?p():a.key==="Escape"&&(n.remove(),this.wrapper.show(),this.isEditing=!1)})}setValue(e,i){if(e===this.value)return;const n=2,r=this.value.toString(),p=e.toString(),a=this.digits.length,u=Math.max(n,p.length);if(u>a)for(let h=a;h<u;h++){const g=new m("0");this.digits.unshift(g),this.wrapper.prepend(g.element),g.initializePosition()}else if(u<a)for(let h=u;h<a;h++)this.digits[0].element.remove(),this.digits.shift();u===3?this.wrapper.addClass("has-three-digits"):this.wrapper.removeClass("has-three-digits");const k=r.padStart(this.digits.length,"0"),T=p.padStart(this.digits.length,"0");for(let h=0;h<this.digits.length;h++){const g=parseInt(k[h],10),M=parseInt(T[h],10);g!==M&&this.digits[h].setValue(M,i)}this.value=e}increment(){let e=!1,i=this.value+1;return i>this.config.max&&(this.config.wrap?(i=this.config.min,e=!0):i=this.config.max),this.setValue(i,1),e}decrement(){let e=!1,i=this.value-1;return i<this.config.min&&this.config.wrap&&(i=this.config.max,e=!0),this.setValue(i,-1),e}};S(b,"LIMITS",{"pix-days":{min:0,max:400,wrap:!0},hours:{min:0,max:23,wrap:!0},minutes:{min:0,max:59,wrap:!0}});let v=b,o={};paghiper_backend_settings.is_pix&&paghiper_backend_settings.due_date_mode==="minutes"&&(w(),t("#paghiper-due-date-container .chevron-control").on("click",function(){if(t(".odometer-input").length){t(".odometer-input").trigger("blur");return}const l=t(this),e=l.data("unit");l.data("action")==="increment"?o[e].increment()&&(e==="minutes"?o.hours.increment()&&o.days.increment():e==="hours"&&o.days.increment()):o[e].decrement()&&(e==="minutes"?o.hours.decrement()&&o.days.decrement():e==="hours"&&o.days.decrement()),x(),_()}))}t("body").on("click","#paghiper-resend-ajax-button",function(c){c.preventDefault();const m=t(this),v=m.data("order-id"),o=t("#woo_paghiper_expiration_date").val();if(o/60>24&&!confirm("A data de vencimento é maior que 24 horas a partir de agora. O cronômetro de contagem regressiva não será exibido no e-mail do cliente. Deseja continuar?"))return;m.prop("disabled",!0).text("Enviando...");const x={action:"paghiper_resend_payment",order_id:v,total_minutes:o,security:t("#paghiper_resend_nonce").val()};t.post(ajaxurl,x,function(w){w.success?(I({message:w.data.message,type:"success"}),setTimeout(()=>window.location.reload(),2e3)):I({message:w.data.message,type:"error"}),m.prop("disabled",!1).text("Definir e Reenviar")}).fail(function(){I({message:"Ocorreu um erro inesperado. Tente novamente.",type:"error"}),m.prop("disabled",!1).text("Definir e Reenviar")})})});async function C(t){if(navigator.clipboard&&window.isSecureContext)try{return await navigator.clipboard.writeText(t),!0}catch(f){console.error("Falha ao copiar com a API moderna: ",f)}const s=document.createElement("textarea");s.value=t,s.style.position="fixed",s.style.top="-9999px",s.style.left="-9999px",document.body.appendChild(s),s.focus(),s.select();let d=!1;try{d=document.execCommand("copy")}catch(f){console.error("Erro ao tentar copiar com o método de fallback: ",f)}return document.body.removeChild(s),d}function I(t){const{message:s,type:d="info",duration:f=3e3}=t,y=document.getElementById("ph-reusable-notifications");if(!y)return null;const c=document.createElement("div");return c.className=`ph-notification ${d}`,c.innerHTML=s,y.appendChild(c),f>0&&setTimeout(()=>{c.classList.add("fade-out"),c.addEventListener("animationend",()=>{c.remove()})},f),c}window.copyPaghiperEmv=function(){let t=document.querySelector(".paghiper-pix-code"),s=t.querySelector("textarea"),d=t.querySelector("button");s.select(),s.setSelectionRange(0,99999),navigator.clipboard.writeText(s.value),d.dataset.originalText=d.innerHTML,d.innerHTML="Copiado!",setTimeout(function(f){let y=f.dataset.originalText;f.innerHTML=y,document.getSelection().removeAllRanges()},2e3,d)};
//# sourceMappingURL=backend.min.js.map
})();