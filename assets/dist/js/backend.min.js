(function(){var E=Object.defineProperty;var C=(t,a,c)=>a in t?E(t,a,{enumerable:!0,configurable:!0,writable:!0,value:c}):t[a]=c;var D=(t,a,c)=>C(t,typeof a!="symbol"?a+"":a,c);jQuery(document).ready(function(t){if(typeof t.fn.mask=="function"&&t(".date").mask("00/00/0000",{placeholder:"__/__/____",clearIfNotMatch:!0}),t(".paghiper-copy-transaction-id").on("click",function(){const d=t(this).data("transaction-id");d&&(V(d),I({message:"ID da transação copiado!",type:"success"}))}),t("#paghiper-due-date-container").length){let w=function(){if(paghiper_backend_settings.due_date_mode==="minutes"){const l=s.days.value,e=s.hours.value,i=s.minutes.value,n=l*24*60+e*60+i;d.val(n).trigger("change")}else d.val(x.value*24*60).trigger("change")},v=function(){if(paghiper_backend_settings.due_date_mode==="minutes"){const l=s.days;l.value===l.config.max&&(s.hours.value!==0&&s.hours.setValue(0,-1),s.minutes.value!==0&&s.minutes.setValue(0,-1))}},M=function(){let l={days:0,hours:0,minutes:0};const e=paghiper_backend_settings.initial_datetime_value;if(e){const i=e.match(/(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})/);if(i){const n=parseInt(i[1],10),r=parseInt(i[2],10)-1,p=parseInt(i[3],10),o=parseInt(i[4],10),u=parseInt(i[5],10),k=new Date(n,r,p,o,u,0),T=new Date,h=k.getTime()-T.getTime(),f=Math.round(h/(1e3*60));f>0&&(l={days:Math.floor(f/(24*60)),hours:Math.floor(f%(24*60)/60),minutes:f%60})}}paghiper_backend_settings.due_date_mode==="minutes"?(s.days=new g(t("#cron-days-backend-minutes"),l.days,"pix-days"),s.hours=new g(t("#cron-hours-backend"),l.hours,"hours"),s.minutes=new g(t("#cron-minutes-backend"),l.minutes,"minutes")):(x=new g(t("#cron-days-backend"),l.days,"pix-days"),console.log("Doing alternative init")),v(),w()};var c=w,m=v,_=M;const d=t("#woo_paghiper_expiration_date");class y{constructor(e){this.element=t('<div class="odometer-digit"></div>'),this.currentValue=parseInt(e,10),this.rotor=t('<div class="odometer-rotor"></div>');for(let i=0;i<10;i++)this.rotor.append(t('<div class="odometer-digit-value"></div>').text(i));this.rotor.append(t('<div class="odometer-digit-value"></div>').text(0)),this.element.append(this.rotor)}initializePosition(){const e=this.element.height();e!==0&&this.rotor.css({transition:"none",transform:`translateY(-${this.currentValue*e}px)`})}setValue(e,i){if(e===this.currentValue)return;const n=this.element.height();if(n===0)return;const r=this.rotor,p=this.currentValue===9&&e===0&&i>0,o=this.currentValue===0&&e===9&&i<0;p?(r.css({transition:"transform 0.4s ease-in-out"}),r.css({transform:`translateY(-${10*n}px)`}),setTimeout(()=>{r.css({transition:"none",transform:"translateY(0px)"})},400)):o?(r.css({transition:"none",transform:`translateY(-${10*n}px)`}),setTimeout(()=>{r.css({transition:"transform 0.4s ease-in-out"}),r.css({transform:`translateY(-${9*n}px)`})},20)):(r.css({transition:"transform 0.4s ease-in-out"}),r.css({transform:`translateY(-${e*n}px)`})),this.currentValue=e}}const b=class b{constructor(e,i,n){this.container=t(e),this.config=b.LIMITS[n],this.value=Math.max(this.config.min,Math.min(i,this.config.max)),this.digits=[],this.isEditing=!1,this.wrapper=t('<div class="odometer-display"></div>'),this.container.html(this.wrapper);const p=this.value.toString().padStart(2,"0");for(let o=0;o<p.length;o++){const u=new y(p[o]);this.digits.push(u),this.wrapper.append(u.element),u.initializePosition()}this.digits.length===3?this.wrapper.addClass("has-three-digits"):this.wrapper.removeClass("has-three-digits"),this.wrapper.on("click",()=>{this.isEditing||this.showInput()})}showInput(){let e=this.wrapper.outerWidth(),i=this.wrapper.outerHeight();this.isEditing=!0,this.wrapper.hide();const n=t('<input type="number" class="odometer-input" />');n.css({width:e+"px",height:i+"px","font-size":"1.8em","text-align":"center",border:"1px solid #999","background-color":"#fff","box-sizing":"border-box",margin:0,padding:0}),n.val(this.value),this.container.append(n),n.focus().select();const r=t('<span style="display:none"></span>');r.css({"font-size":n.css("font-size"),"font-family":n.css("font-family")}),t("body").append(r),n.on("input",function(){r.text(t(this).val()),t(this).css("width",r.width()+10+"px")}).trigger("input");const p=()=>{let o=parseInt(n.val(),10);if(isNaN(o)?o=this.value:o=Math.max(this.config.min,Math.min(o,this.config.max)),n.remove(),this.wrapper.show(),this.isEditing=!1,o!==this.value){const u=o>this.value?1:-1;this.setValue(o,u),v(),w()}};n.on("blur",p),n.on("keydown",o=>{o.key==="Enter"?p():o.key==="Escape"&&(n.remove(),this.wrapper.show(),this.isEditing=!1)})}setValue(e,i){if(e===this.value)return;const n=2,r=this.value.toString(),p=e.toString(),o=this.digits.length,u=Math.max(n,p.length);if(u>o)for(let h=o;h<u;h++){const f=new y("0");this.digits.unshift(f),this.wrapper.prepend(f.element),f.initializePosition()}else if(u<o)for(let h=u;h<o;h++)this.digits[0].element.remove(),this.digits.shift();u===3?this.wrapper.addClass("has-three-digits"):this.wrapper.removeClass("has-three-digits");const k=r.padStart(this.digits.length,"0"),T=p.padStart(this.digits.length,"0");for(let h=0;h<this.digits.length;h++){const f=parseInt(k[h],10),S=parseInt(T[h],10);f!==S&&this.digits[h].setValue(S,i)}this.value=e}increment(){let e=!1,i=this.value+1;return i>this.config.max&&(this.config.wrap?(i=this.config.min,e=!0):i=this.config.max),this.setValue(i,1),e}decrement(){let e=!1,i=this.value-1;return i<this.config.min&&this.config.wrap&&(i=this.config.max,e=!0),this.setValue(i,-1),e}};D(b,"LIMITS",{"pix-days":{min:0,max:400,wrap:!0},hours:{min:0,max:23,wrap:!0},minutes:{min:0,max:59,wrap:!0}});let g=b,s={},x;M(),t("#paghiper-due-date-container .chevron-control").on("click",function(){if(t(".odometer-input").length){t(".odometer-input").trigger("blur");return}const l=t(this),e=l.data("unit"),i=l.data("action");paghiper_backend_settings.due_date_mode==="minutes"?i==="increment"?s[e].increment()&&(e==="minutes"?s.hours.increment()&&s.days.increment():e==="hours"&&s.days.increment()):s[e].decrement()&&(e==="minutes"?s.hours.decrement()&&s.days.decrement():e==="hours"&&s.days.decrement()):i==="increment"?x.increment():x.decrement(),v(),w()})}t("body").on("click","#paghiper-resend-ajax-button",function(d){d.preventDefault();const y=t(this),g=y.data("order-id"),s=t("#woo_paghiper_expiration_date").val();if(paghiper_backend_settings.due_date_mode==="minutes"&&s<5&&!confirm(`A transação gerada vai expirar em apenas ${s} minutos. Continuar?`))return;const x=s/60;if(paghiper_backend_settings.due_date_mode==="minutes"&&x>24&&!confirm("A data de vencimento é maior que 24 horas a partir de agora. O cronômetro de contagem regressiva não será exibido no e-mail do cliente. Deseja continuar?"))return;y.prop("disabled",!0).text("Enviando...");const w={action:"paghiper_resend_payment",order_id:g,total_minutes:s,security:t("#paghiper_resend_nonce").val()};t.post(ajaxurl,w,function(v){v.success?(I({message:v.data.message,type:"success"}),setTimeout(()=>window.location.reload(),2e3)):I({message:v.data.message,type:"error"}),y.prop("disabled",!1).text("Definir e Reenviar")}).fail(function(){I({message:"Ocorreu um erro inesperado. Tente novamente.",type:"error"}),y.prop("disabled",!1).text("Definir e Reenviar")})})});async function V(t){if(navigator.clipboard&&window.isSecureContext)try{return await navigator.clipboard.writeText(t),!0}catch(m){console.error("Falha ao copiar com a API moderna: ",m)}const a=document.createElement("textarea");a.value=t,a.style.position="fixed",a.style.top="-9999px",a.style.left="-9999px",document.body.appendChild(a),a.focus(),a.select();let c=!1;try{c=document.execCommand("copy")}catch(m){console.error("Erro ao tentar copiar com o método de fallback: ",m)}return document.body.removeChild(a),c}function I(t){const{message:a,type:c="info",duration:m=3e3}=t,_=document.getElementById("ph-reusable-notifications");if(!_)return null;const d=document.createElement("div");return d.className=`ph-notification ${c}`,d.innerHTML=a,_.appendChild(d),m>0&&setTimeout(()=>{d.classList.add("fade-out"),d.addEventListener("animationend",()=>{d.remove()})},m),d}window.copyPaghiperEmv=function(){let t=document.querySelector(".paghiper-pix-code"),a=t.querySelector("textarea"),c=t.querySelector("button");a.select(),a.setSelectionRange(0,99999),navigator.clipboard.writeText(a.value),c.dataset.originalText=c.innerHTML,c.innerHTML="Copiado!",setTimeout(function(m){let _=m.dataset.originalText;m.innerHTML=_,document.getSelection().removeAllRanges()},2e3,c)};
//# sourceMappingURL=backend.min.js.map
})();