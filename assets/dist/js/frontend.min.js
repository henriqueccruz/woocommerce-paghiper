(function(){jQuery(document).ready(function(e){if(typeof e(".paghiper_tax_id").mask=="function"){let n=function(){var o=function(i){return i.replace(/\D/g,"").length>11?"00.000.000/0000-00":"000.000.000-009"};e(".paghiper_tax_id").mask(o,{clearIfNotMatch:!0,placeholder:"___.___.___-__",onKeyPress:function(i,a,s,l){s.mask(o.apply({},arguments),l)}})};var t=n;e(document.body).on("updated_checkout",function(o){n()}),n()}e(document.body).on("updated_checkout",function(n){y()}),y()});function y(){let e=document.querySelectorAll('[name="billing_cpf"], [name="billing_cnpj"]'),t=document.querySelectorAll('[name="billing_first_name"], [name="billing_company"]'),n=document.querySelectorAll(".wc-paghiper-form");[].forEach.call(n,o=>{let i=o.querySelector(".paghiper-taxid-fieldset"),a=o.querySelector(".paghiper-payername-fieldset"),s=!1,l=!1;i&&(e.length>0?i.classList.add("paghiper-hidden"):(i.classList.remove("paghiper-hidden"),s=!0)),a&&(t.length>0?a.classList.add("paghiper-hidden"):(a.classList.remove("paghiper-hidden"),l=!0)),!s&&!l?o.classList.add("paghiper-hidden"):o.classList.remove("paghiper-hidden")})}window.copyPaghiperEmv=function(){let e=document.querySelector(".paghiper-pix-code"),t=e.querySelector("textarea"),n=e.querySelector("button");t.select(),t.setSelectionRange(0,99999),navigator.clipboard.writeText(t.value),n.dataset.originalText=n.innerHTML,n.innerHTML="Copiado!",setTimeout(function(o){let i=o.dataset.originalText;o.innerHTML=i,document.getSelection().removeAllRanges()},2e3,n)};async function _(e){if(navigator.clipboard&&window.isSecureContext)try{return await navigator.clipboard.writeText(e),!0}catch(o){console.error("Falha ao copiar com a API moderna: ",o)}const t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.top="-9999px",t.style.left="-9999px",document.body.appendChild(t),t.focus(),t.select();let n=!1;try{n=document.execCommand("copy")}catch(o){console.error("Erro ao tentar copiar com o método de fallback: ",o)}return document.body.removeChild(t),n}function p(e){const{message:t,type:n="info",duration:o=3e3}=e,i=document.getElementById("ph-reusable-notifications");if(!i)return null;const a=document.createElement("div");return a.className=`ph-notification ${n}`,a.innerHTML=t,i.appendChild(a),o>0&&setTimeout(()=>{a.classList.add("fade-out"),a.addEventListener("animationend",()=>{a.remove()})},o),a}async function g(){p({message:'<span class="ph-notification-spinner"></span> Por favor aguarde...',type:"warning",duration:5e3});try{const n=await(await fetch(window.location.href)).text(),a=new DOMParser().parseFromString(n,"text/html").querySelector(".ph-checkout-v2"),s=document.querySelector(".ph-checkout-v2");a&&s?s.innerHTML=a.innerHTML:window.location.reload()}catch(t){console.error("Falha ao atualizar o conteúdo do checkout:",t),window.location.reload()}}document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".ph-checkout-v2__copy-code-button"),t=document.querySelector(".ph-checkout-v2__qr-container"),n=document.querySelector(".ph-checkout-v2__copy-code-container .textarea-container"),o=async()=>{var c;const r=(c=document.querySelector(".ph-checkout-v2__copy-code-container .digitable_line_container"))==null?void 0:c.textContent.trim();if(!r)return;if(await _(r)&&(p({message:"Código PIX copiado com sucesso!",type:"success"}),e)){const u=e.dataset.originalText||e.textContent;e.dataset.originalText||(e.dataset.originalText=u),e.textContent="Copiado!",setTimeout(()=>{e.textContent=u},2e3)}},i=r=>{const d=r.currentTarget.querySelector(".digitable_line_container");if(window.getSelection&&document.createRange){const c=window.getSelection(),u=document.createRange();u.selectNodeContents(d),c.removeAllRanges(),c.addRange(u)}};e&&e.addEventListener("click",o),t&&t.addEventListener("click",o),n&&n.addEventListener("click",i);const a=()=>{let r=null;const d=ph_checkout_params==null?void 0:ph_checkout_params.order_id,c=ph_checkout_params==null?void 0:ph_checkout_params.nonce;if(!d||!c)return;const u=setInterval(()=>{(!r||!document.body.contains(r))&&(r=p({message:'<span class="ph-notification-spinner"></span> Aguardando confirmação do pagamento...',type:"info",duration:0})),jQuery.post(ph_checkout_params.ajax_url,{action:"paghiper_check_payment_status",security:c,order_id:d},function(m){m.success?m.data.status==="paid"&&(clearInterval(u),r&&r.remove(),p({message:"Pagamento confirmado com sucesso!",type:"success",duration:5e3}),setTimeout(()=>{g()},1e3)):(clearInterval(u),console.error("Erro ao verificar status do pagamento:",m.data.message))})},1e4)};document.querySelector('.ph-checkout-v2[data-status="pending"]')&&typeof ph_checkout_params<"u"&&a();const s=document.getElementById("ph-i-paid-button");s&&s.addEventListener("click",()=>{x()});const l=document.getElementById("ph-restore-cart-button");l&&l.addEventListener("click",()=>{const r=ph_checkout_params==null?void 0:ph_checkout_params.order_id,d=ph_checkout_params==null?void 0:ph_checkout_params.nonce;if(!r||!d)return;const c='<span class="ph-notification-spinner" style="border-top-color: #fff;"></span>',u=p({message:`${c} Restaurando seu carrinho...`,type:"info",duration:0});jQuery.post(ph_checkout_params.ajax_url,{action:"paghiper_restore_cart",security:d,order_id:r},function(m){m.success?(u&&(u.innerHTML=`${c} Redirecionando você para a tela de checkout...`),setTimeout(()=>{window.location.href=m.data.redirect_url},2e3)):(u&&u.remove(),p({message:"Ocorreu um erro ao tentar restaurar seu carrinho. Por favor, tente novamente.",type:"error"}))})})});let h=!1;function f(e){return new Promise(t=>setTimeout(t,e))}async function v(e,t,n,o,i,a){let s=0;const l=async()=>{if(!document.body.contains(e)||(await f(o),!document.body.contains(e)))return;const r=n[s];for(let c=r.length;c>=0;c--){if(!document.body.contains(e))return;t.textContent=r.substring(0,c),await f(i/r.length)}s=(s+1)%n.length;const d=n[s];for(let c=0;c<d.length;c++){if(!document.body.contains(e))return;t.textContent+=d[c],await f(a/d.length)}l()};l()}const x=()=>{if(h)return;h=!0;const e=document.getElementById("ph-i-paid-button");e&&(e.disabled=!0);const t=ph_checkout_params==null?void 0:ph_checkout_params.order_id,n=ph_checkout_params==null?void 0:ph_checkout_params.nonce;if(!t||!n){h=!1,e&&(e.disabled=!1);return}const o='<span class="ph-notification-spinner"></span>',i=["Estamos confirmando seu pagamento, só um instante...","Às vezes o banco leva um tempinho para nos notificar.","Não se preocupe, vamos continuar verificando por aqui."],a=p({message:`${o} <span>${i[0]}</span>`,type:"warning",duration:0}),s=a.querySelector("span:last-child");v(a,s,i,6e3,250,1e3);const l=()=>{jQuery.post(ph_checkout_params.ajax_url,{action:"paghiper_check_payment_status",security:n,order_id:t},function(c){c.success&&c.data.status==="paid"&&(clearInterval(r),clearTimeout(d),a.remove(),p({message:"Pagamento confirmado!",type:"success"}),setTimeout(()=>{typeof g=="function"?g():window.location.reload()},1e3))})},r=setInterval(l,15e3),d=setTimeout(()=>{clearInterval(r),a.remove(),p({message:"Ainda não recebemos a confirmação do seu pagamento.",type:"error"}),h=!1,e&&(e.disabled=!1)},18e5);l()};
//# sourceMappingURL=frontend.min.js.map
})();